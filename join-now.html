<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="join-now.style.css">
    <link rel="stylesheet" href="common.style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;900&display=swap');
    </style>
    <!-- <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap');
    </style> -->
    <title>Crypto10</title>
</head>

<body>

    <header>
        <img src="assets/logo-with-name.svg" alt="">
    </header>

    <main>
        <h1 class="main-slogan">Choose the coin you want to pay with</h1>
        <div class="crypto-coins-container">
            <div class="coin-cointainer" onclick="openTransactionForm('ETH')">
                <img src="assets/crypto-coins/eth.svg" alt="eth">
                <p class="coin-text eth"></p>
            </div>
            <div class="coin-cointainer" onclick="openTransactionForm('BTC')">
                <img src="assets/crypto-coins/btc.svg" alt="btc">
                <p class="coin-text btc"></p>
            </div>
            <div class="coin-cointainer" onclick="openTransactionForm('USDT')">
                <img src="assets/crypto-coins/usdt.svg" alt="usdt">
                <p class="coin-text usdt"></p>
            </div>
        </div>

        <div class="need-help-join-btn-container">
            <button class="need-help-join-btn">
                NEED HELP JOINING?
            </button>
        </div>

        <div class="form-container hidden">
            <div class="wallet-address-div">
                Wallet address
                <p class="copy-tooltip"><span class="wallet-address-text"></span> <img class="copy-icon" src="assets/copy-icon.svg" alt=""><span class="copy-tooltiptext">Copy</span></p>
                
            </div>

            <div class="qr-code-container">
                <div class="qr-code">
                </div>
            </div>

            <form action="https://fabform.io/f/uOedpx2" method="post">
                <div class="header">
                    Just fill this and you're good to go!
                </div>
                <div class="main">
                    <input type="text" name="transactionLink" id="transactionLink" placeholder="Transaction link">
                    <input type="text"  name="telegramUsername"  id="telegramUsername" placeholder="Telegram username">
    
                    <button type="submit" class="submit-btn">SUBMIT</div>
                </div>
            </form>
        </div>
    </main>





    <footer>
        <img src="assets/logo10-negative.svg" alt="">
        <small class="copyright">&copy; Copyright <span class="copy-year"></span>, <a href="https://9320.tech">Tech9320
                team</a>. All rights reserved.</small>
    </footer>

    <script>
        let walletAddressETH = '0x3232abc0dd7fe7835a3ddd389c165cc4ba435'; 
        let walletAddressBTC = '0x95222290dd7278aa3ddd389c165cc4bafe5'; 
        let walletAddressUSDT = '0x95111111223233dddabcc1004b22f'; 

        let QR_Code;

        function openTransactionForm(coin) {
            const formContainer = document.querySelector('.form-container');
            formContainer.classList.remove('hidden');

            setTimeout(()=>{
                formContainer.scrollIntoView(true);
            }, 1);

            let walletAddress;
            if(coin == 'ETH'){
                walletAddress = walletAddressETH
            }else if(coin == 'BTC'){
                walletAddress = walletAddressBTC
            }else if(coin == 'USDT'){
                walletAddress = walletAddressUSDT
            }

            if(QR_Code){
                QR_Code.makeCode(walletAddress);
            }else{
                generateQR(walletAddress)
            }

            document.querySelector('.wallet-address-text').innerHTML = walletAddress
        }

        document.querySelector('.copy-year').innerText = new Date().getFullYear();

        function generateQR(value) {
            QR_Code = new QRCode(document.querySelector(".qr-code"), {
                text: `${value}`,
                width: 128,
                height: 128,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        } 

        const walletAddressBtn = document.querySelector('.wallet-address-div p')
        walletAddressBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(walletAddress);
            const toolTipText = document.querySelector('.copy-tooltiptext');
            toolTipText.innerHTML = 'Copied!'
            setTimeout(()=>{
                toolTipText.innerHTML = 'Copy'
            },2000)
        })

        const coinTextETH = document.querySelector('.coin-text.eth')
        const coinTextBTC = document.querySelector('.coin-text.btc')
        const coinTextUSDT = document.querySelector('.coin-text.usdt')

        fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,tether&vs_currencies=usd')
        .then(response => response.json())
        .then(response => {
            coinTextETH.innerHTML = `10$ = ${(10/response.bitcoin.usd).toFixed(8)} ETH`;
            coinTextBTC.innerHTML = `10$ = ${(10/response.ethereum.usd).toFixed(8)} BTC`;
            coinTextUSDT.innerHTML = `10$ = ${(10/response.tether.usd).toFixed(8)} USDT`;
        })
        .catch(error => {
            coinTextETH.innerHTML = 'ETH';
            coinTextBTC.innerHTML = 'BTC'
            coinTextUSDT.innerHTML = 'USDT'
        })

        function submitTransaction(event){
            event.preventDefault();

            const transactionLinkInput = document.querySelector('input#transactionLink')
            if(!transactionLinkInput){
                alert('Error');
                console.log('Transaction link missing');
                return;
            }

            const telegramUsernameInput = document.querySelector('input#telegramUsername')
            if(!telegramUsernameInput){
                alert('Error');
                console.log('Telegram username missing');
                return;
            }

            if(!transactionLinkInput.value || !telegramUsernameInput.value){
                alert("Please fill in all fields");
                return;
            }

            let formData = new FormData();

            formData.append('transactionLink', transactionLinkInput.value);
            formData.append('telegramUsername', telegramUsernameInput.value);

            fetch('https://fabform.io/f/uOedpx2', {
                method: 'POST',
                body: formData
            }).then(response => response.json())
            .then(console.log)
            .catch(console.log)
        }
    </script>
</body>

</html>